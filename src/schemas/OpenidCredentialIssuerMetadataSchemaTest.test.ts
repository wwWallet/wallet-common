import { describe, it } from 'vitest';
import { OpenidCredentialIssuerMetadataSchema } from './OpenidCredentialIssuerMetadataSchema';
import assert from 'assert';



const metadata = {"credential_issuer":"https://playground.animo.id/oid4vci/832f1c72-817d-4a54-b0fc-9994ecaba291","credential_endpoint":"https://playground.animo.id/oid4vci/832f1c72-817d-4a54-b0fc-9994ecaba291/credential","deferred_credential_endpoint":"https://playground.animo.id/oid4vci/832f1c72-817d-4a54-b0fc-9994ecaba291/deferred-credential","nonce_endpoint":"https://playground.animo.id/oid4vci/832f1c72-817d-4a54-b0fc-9994ecaba291/nonce","batch_credential_issuance":{"batch_size":10},"display":[{"name":"Bürgeramt Köln","logo":{"uri":"https://playground.animo.id/assets/issuers/koln/issuer.png","url":"https://playground.animo.id/assets/issuers/koln/issuer.png"}}],"credential_configurations_supported":{"certificate-of-residence-sd-jwt":{"format":"dc+sd-jwt","scope":"certificate-of-residence-sd-jwt","cryptographic_binding_methods_supported":["jwk"],"credential_signing_alg_values_supported":["ES256"],"proof_types_supported":{"jwt":{"proof_signing_alg_values_supported":["ES256"]}},"credential_metadata":{"display":[{"name":"Certificate of Residence","locale":"en","background_color":"#E4DEDD","background_image":{"uri":"https://playground.animo.id/assets/issuers/koln/credential.png","url":"https://playground.animo.id/assets/issuers/koln/credential.png"},"text_color":"#525C75"}]},"vct":"https://example.eudi.ec.europa.eu/cor/1","display":[{"locale":"en","name":"Certificate of Residence","text_color":"#525C75","background_color":"#E4DEDD","background_image":{"url":"https://playground.animo.id/assets/issuers/koln/credential.png","uri":"https://playground.animo.id/assets/issuers/koln/credential.png"}}]},"certificate-of-residence-sd-jwt-key-attestations":{"format":"dc+sd-jwt","scope":"certificate-of-residence-sd-jwt","cryptographic_binding_methods_supported":["jwk"],"credential_signing_alg_values_supported":["ES256"],"proof_types_supported":{"jwt":{"proof_signing_alg_values_supported":["ES256"],"key_attestations_required":{"key_storage":["iso_18045_high"],"user_authentication":["iso_18045_high"]}},"attestation":{"proof_signing_alg_values_supported":["ES256"],"key_attestations_required":{"key_storage":["iso_18045_high"],"user_authentication":["iso_18045_high"]}}},"credential_metadata":{"display":[{"name":"Certificate of Residence","locale":"en","background_color":"#E4DEDD","background_image":{"uri":"https://playground.animo.id/assets/issuers/koln/credential.png","url":"https://playground.animo.id/assets/issuers/koln/credential.png"},"text_color":"#525C75"}]},"vct":"https://example.eudi.ec.europa.eu/cor/1","display":[{"locale":"en","name":"Certificate of Residence","text_color":"#525C75","background_color":"#E4DEDD","background_image":{"url":"https://playground.animo.id/assets/issuers/koln/credential.png","uri":"https://playground.animo.id/assets/issuers/koln/credential.png"}}]},"certificate-of-residence-mdoc":{"format":"mso_mdoc","scope":"certificate-of-residence-mdoc","cryptographic_binding_methods_supported":["cose_key"],"credential_signing_alg_values_supported":[-9],"proof_types_supported":{"jwt":{"proof_signing_alg_values_supported":["ES256"]}},"credential_metadata":{"display":[{"name":"Certificate of Residence","locale":"en","background_color":"#E4DEDD","background_image":{"uri":"https://playground.animo.id/assets/issuers/koln/credential.png","url":"https://playground.animo.id/assets/issuers/koln/credential.png"},"text_color":"#525C75"}]},"doctype":"eu.europa.ec.eudi.cor.1","display":[{"locale":"en","name":"Certificate of Residence","text_color":"#525C75","background_color":"#E4DEDD","background_image":{"url":"https://playground.animo.id/assets/issuers/koln/credential.png","uri":"https://playground.animo.id/assets/issuers/koln/credential.png"}}]},"certificate-of-residence-mdoc-key-attestations":{"format":"mso_mdoc","scope":"certificate-of-residence-mdoc","cryptographic_binding_methods_supported":["cose_key"],"credential_signing_alg_values_supported":[-9],"proof_types_supported":{"jwt":{"proof_signing_alg_values_supported":["ES256"],"key_attestations_required":{"key_storage":["iso_18045_high"],"user_authentication":["iso_18045_high"]}},"attestation":{"proof_signing_alg_values_supported":["ES256"],"key_attestations_required":{"key_storage":["iso_18045_high"],"user_authentication":["iso_18045_high"]}}},"credential_metadata":{"display":[{"name":"Certificate of Residence","locale":"en","background_color":"#E4DEDD","background_image":{"uri":"https://playground.animo.id/assets/issuers/koln/credential.png","url":"https://playground.animo.id/assets/issuers/koln/credential.png"},"text_color":"#525C75"}]},"doctype":"eu.europa.ec.eudi.cor.1","display":[{"locale":"en","name":"Certificate of Residence","text_color":"#525C75","background_color":"#E4DEDD","background_image":{"url":"https://playground.animo.id/assets/issuers/koln/credential.png","uri":"https://playground.animo.id/assets/issuers/koln/credential.png"}}]}},"credentials_supported":[{"format":"vc+sd-jwt","cryptographic_binding_methods_supported":["jwk"],"vct":"https://example.eudi.ec.europa.eu/cor/1","cryptographic_suites_supported":["ES256"],"display":[{"locale":"en","name":"Certificate of Residence","text_color":"#525C75","background_color":"#E4DEDD","logo":{"url":"https://playground.animo.id/assets/issuers/koln/credential.png"}}],"id":"certificate-of-residence-sd-jwt"},{"format":"vc+sd-jwt","cryptographic_binding_methods_supported":["jwk"],"vct":"https://example.eudi.ec.europa.eu/cor/1","cryptographic_suites_supported":["ES256"],"display":[{"locale":"en","name":"Certificate of Residence","text_color":"#525C75","background_color":"#E4DEDD","logo":{"url":"https://playground.animo.id/assets/issuers/koln/credential.png"}}],"id":"certificate-of-residence-sd-jwt-key-attestations"},{"format":"mso_mdoc","cryptographic_binding_methods_supported":["cose_key"],"doctype":"eu.europa.ec.eudi.cor.1","cryptographic_suites_supported":["ES256"],"display":[{"locale":"en","name":"Certificate of Residence","text_color":"#525C75","background_color":"#E4DEDD","logo":{"url":"https://playground.animo.id/assets/issuers/koln/credential.png"}}],"id":"certificate-of-residence-mdoc"},{"format":"mso_mdoc","cryptographic_binding_methods_supported":["cose_key"],"doctype":"eu.europa.ec.eudi.cor.1","cryptographic_suites_supported":["ES256"],"display":[{"locale":"en","name":"Certificate of Residence","text_color":"#525C75","background_color":"#E4DEDD","logo":{"url":"https://playground.animo.id/assets/issuers/koln/credential.png"}}],"id":"certificate-of-residence-mdoc-key-attestations"}],"token_endpoint":"https://playground.animo.id/oid4vci/832f1c72-817d-4a54-b0fc-9994ecaba291/token","dpop_signing_alg_values_supported":["ES256"]}

describe("OpenidCredentialIssuerMetadataSchemaEudiw", () => {
	it("should successfully parse Animo issuer's metadata", async () => {
		const res = OpenidCredentialIssuerMetadataSchema.safeParse(metadata);
		if (res.error) {
			console.dir(res.error, { depth: null });
		}
		assert(res.success === true);
	})
})
